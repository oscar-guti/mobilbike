name: Build Flutter APK

on:
  push:
    # El flujo de trabajo se ejecuta cada vez que subes (push) a la rama 'main'.
    branches:
      - main

jobs:
  build:
    # Usa un sistema operativo reciente
    runs-on: ubuntu-latest
    
    steps:
      - name: â¬‡ï¸ Checkout repo
        # Obtiene el cÃ³digo de tu repositorio
        uses: actions/checkout@v4 # Actualizado a la Ãºltima versiÃ³n

      - name: âš™ï¸ Set up Flutter
        uses: subosito/flutter-action@v2
        with:
          # CORRECCIÃ“N: Usamos 'stable' para garantizar que siempre funcione con una versiÃ³n vÃ¡lida.
          # TambiÃ©n puedes usar una versiÃ³n especÃ­fica como '3.22.2' si lo prefieres.
          channel: 'stable'
          
      - name: ğŸ“¦ Install dependencies
        run: flutter pub get

      - name: ğŸ§ª Run tests (Optional, but recommended)
        run: flutter test

      - name: ğŸ—ï¸ Build APK (release)
        # Compila la versiÃ³n final (release)
        run: flutter build apk --release

      - name: â¬†ï¸ Upload APK artifact
        # Sube el APK para que puedas descargarlo desde GitHub
        uses: actions/upload-artifact@v4
        with:
          name: app-release
          # Ruta estÃ¡ndar donde Flutter coloca el APK de release
          path: build/app/outputs/flutter-apk/app-release.apk
          # Recomendado: Controla el tiempo que el artefacto estarÃ¡ disponible (e.g., 5 dÃ­as)
          retention-days: 5